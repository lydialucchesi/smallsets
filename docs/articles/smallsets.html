<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="smallsets">
<title>smallsets User Guide • smallsets</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="smallsets User Guide">
<meta property="og:description" content="smallsets">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">smallsets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/smallsets.html">User guide</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions and data</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="https://lydialucchesi.github.io/smallsets_cheatsheet/smallsets_cheatsheet.pdf">Cheatsheet</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://dl.acm.org/doi/pdf/10.1145/3531146.3533175">Smallset Timelines</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Package news</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lydialucchesi/smallsets/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>smallsets User Guide</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lydialucchesi/smallsets/blob/HEAD/vignettes/smallsets.Rmd" class="external-link"><code>vignettes/smallsets.Rmd</code></a></small>
      <div class="d-none name"><code>smallsets.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="smallset-timelines">Smallset Timelines<a class="anchor" aria-label="anchor" href="#smallset-timelines"></a>
</h2>
<p>In this vignette, we explain how to use smallsets to build Smallset
Timelines. A Smallset Timeline (or Timeline) is a simple visualisation
of data preprocessing decisions. More information on Timelines can be
found in the Smallset Timeline paper and on YouTube.</p>
<ul>
<li><a href="https://dl.acm.org/doi/abs/10.1145/3531146.3533175" class="external-link">ACM
FAccT paper about Smallset Timelines</a></li>
<li><a href="https://www.youtube.com/watch?v=_fpn02h3IUo" class="external-link">3-minute
YouTube video</a></li>
<li><a href="https://www.youtube.com/watch?v=I_ksOv6rj1Y" class="external-link">15-minute
YouTube video</a></li>
</ul>
</div>
<div class="section level2">
<h2 id="example">Example dataset<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>In this vignette, we use the synthetic dataset s_data, which is
included in smallsets. It contains 100 observations and 8 variables
(C1-C8). See <code><a href="../reference/s_data.html">?s_data</a></code> for more information.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lydialucchesi/smallsets" class="external-link">smallsets</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   C1    C2 C3  C4   C5    C6    C7    C8</span></span>
<span><span class="co">## 1  2  TRUE 33 199 5.44    NA  0.99    NA</span></span>
<span><span class="co">## 2  3  TRUE 31 161 4.84  6.74  1.24  1.22</span></span>
<span><span class="co">## 3  4 FALSE 33 188 5.97  9.35 -0.04  0.59</span></span>
<span><span class="co">## 4  2 FALSE 24 129 4.33  7.80    NA    NA</span></span>
<span><span class="co">## 5  2  TRUE 32 115 6.64 10.64    NA    NA</span></span>
<span><span class="co">## 6  3  TRUE 22 101 3.93  7.18 -1.12 -0.63</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="basics">The basics<a class="anchor" aria-label="anchor" href="#basics"></a>
</h2>
<p>Each Smallset Timeline is constructed from your dataset and R/R
Markdown/Python data preprocessing script. Scripts must contain a series
of <a href="#comments">smallsets comments</a> with snapshot
instructions. Your unprocessed dataset (<code>data</code>) and commented
preprocessing script (<code>code</code>) are the only required inputs to
<code>Smallset_Timeline</code>.</p>
<p><strong>Normally, you pass a character string to <code>code</code>
(e.g., “my_code.R” or “/…/…/my_code.R”).</strong> However, the script
s_data_preprocess.R is included in smallsets as an example and needs to
be called with <code>system.file</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lydialucchesi/smallsets" class="external-link">smallsets</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">145</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Smallset_Timeline.html">Smallset_Timeline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">s_data</span>, </span>
<span>                  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"s_data_preprocess.R"</span>, package <span class="op">=</span> <span class="st">"smallsets"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="smallsets_files/figure-html/timeline1-1.png" width="672" style="display: block; margin: auto;"></p>
<p>If s_data_preprocess.R was located in your working directory, the
code would look like this.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Smallset_Timeline.html">Smallset_Timeline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">s_data</span>, code <span class="op">=</span> <span class="st">"s_data_preprocess.R"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="supported-workflows">Supported workflows<a class="anchor" aria-label="anchor" href="#supported-workflows"></a>
</h3>
<p>The smallsets package currently supports data preprocessing workflows
fitting the following description.</p>
<ol style="list-style-type: decimal">
<li>Your <strong>dataset is tabular</strong> and of class data.frame,
data.table, or tibble. Objects of class data.table and tibble are
immediately converted to a data.frame by smallsets.</li>
<li>All preprocessing code is contained in <strong>one R, R Markdown, or
Python file</strong>. Jupyter notebooks (i.e., files with extension
.ipynb) are not currently supported.</li>
<li>The <strong>preprocessing code does not change the row
names</strong> of the original data object as smallsets tracks rows by
their names. Merges, joins, collapses, aggregations, and switches
between the wide/long format generally involve writing over existing row
names and are therefore generally not currently supported by smallsets.
Renaming a column results in a column deletion then addition in the
Timeline.</li>
<li>All preprocessing <strong>package dependencies are loaded</strong>
in the current R session. Information on installing Python packages with
<code>reticulate</code> can be found <a href="https://rstudio.github.io/reticulate/articles/python_packages.html" class="external-link">here</a>.</li>
</ol>
</div>
<div class="section level3">
<h3 id="comments">Structured comments<a class="anchor" aria-label="anchor" href="#comments"></a>
</h3>
<p>Below is the R preprocessing script for s_data (s_data_preprocess.R).
It contains several smallsets comments. All comments follow the same
formula.</p>
<p><strong>hash + smallsets + instruction + name of data object +
caption[…]caption</strong></p>
<p>There are four instructions available.</p>
<ol style="list-style-type: decimal">
<li>start</li>
<li>end</li>
<li>snap</li>
<li>resume</li>
</ol>
<p>In your script, <em>start</em> and <em>end</em> instructions must be
provided. A snapshot is always taken directly after the <em>start</em>
instruction and immediately before the <em>end</em> instruction. The
<em>snap</em> instruction results in a snapshot being taken after the
subsequent line of code. The <em>resume</em> instruction is discussed in
the section on <a href="#resume">resume markers</a>.</p>
<p>The name of the data object can change throughout the script. The
snapshot is taken of the object specified in the comment.</p>
<p><br><strong>s_data_preprocess.R</strong> (Don’t run this code
block. It’s an example preprocessing script.)</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># smallsets start s_data caption[Remove rows where C2 is FALSE.]caption</span></span>
<span><span class="va">s_data</span> <span class="op">&lt;-</span> <span class="va">s_data</span><span class="op">[</span><span class="va">s_data</span><span class="op">$</span><span class="va">C2</span> <span class="op">==</span> <span class="cn">TRUE</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C6</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C6</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C6</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># smallsets snap s_data caption[Replace missing values in C6 and C8 with column</span></span>
<span><span class="co"># means. Drop C7 because there are too many missing values.]caption</span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C8</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C8</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C7</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C9</span> <span class="op">&lt;-</span> <span class="va">s_data</span><span class="op">$</span><span class="va">C3</span> <span class="op">+</span> <span class="va">s_data</span><span class="op">$</span><span class="va">C4</span></span>
<span><span class="co"># smallsets end s_data caption[Create a new column, C9, by summing C3 and</span></span>
<span><span class="co"># C4.]caption</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="r-markdown-example">R Markdown example<a class="anchor" aria-label="anchor" href="#r-markdown-example"></a>
</h3>
<p>Smallset Timelines can be built for preprocessing code in R Markdown
files. If you choose to include the Smallset Timeline as a figure within
the R Markdown report itself, it works best to build the Smallset
Timeline before the preprocessing code is executed, so that you don’t
have to reload your (un-preprocessed) data later to build the Smallset
Timeline. You assign the Smallset Timeline figure to an object, hiding
that code with <code>echo=FALSE</code>. You can then plot it anywhere in
the report. See the example below.</p>
<p><br><strong>s_data_preprocess.Rmd</strong> (Don’t run this code
block. It’s an example script.)</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>title<span class="sc">:</span> <span class="st">"My data analysis"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>output<span class="sc">:</span> pdf_document</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r setup, include = FALSE}</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="at">options(knitr.kable.NA = "")</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages and data</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>I load my dataset, <span class="st">`</span><span class="at">s_data</span><span class="st">`</span>, which is located <span class="cf">in</span> the <span class="st">`</span><span class="at">smallsets</span><span class="st">`</span> package.</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r data}</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="at">library(smallsets)</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="at">library(knitr)</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="at">head(s_data) |&gt; kable(booktabs = TRUE)</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r timeline, eval = TRUE, echo = FALSE}</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="at">set.seed(145)</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="at">myTimeline &lt;- Smallset_Timeline(data = s_data,</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="at">                  code = system.file("s_data_preprocess.Rmd", package = "smallsets"))</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                  </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocessing</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>I need to preprocess the dataset before I can build a model.</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r preprocess}</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="at"># smallsets start s_data caption[Remove rows where C2 is FALSE.]caption</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="at">s_data &lt;- s_data[s_data$C2 == TRUE,]</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="at">s_data$C6[is.na(s_data$C6)] &lt;- mean(s_data$C6, na.rm = TRUE)</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="at"># smallsets snap s_data caption[Replace missing values in C6 and C8 with column</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="at"># means. Drop C7 because there are too many missing values.]caption</span></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="at">s_data$C8[is.na(s_data$C8)] &lt;- mean(s_data$C8, na.rm = TRUE)</span></span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a><span class="at">s_data$C7 &lt;- NULL</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a><span class="at">s_data$C9 &lt;- s_data$C3 + s_data$C4</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="at"># smallsets end s_data caption[Create a new column, C9, by summing C3 and</span></span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a><span class="at"># C4.]caption</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>Below is a Smallset Timeline, visualising my preprocessing decisions executed above.</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r print, echo = FALSE, fig.align = "center"}</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a><span class="at">myTimeline</span></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>I build a model.</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="st">```</span><span class="at">{r model}</span></span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="at"># code to build a model...</span></span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span></code></pre></div>
<p>To see the compiled report, run the following code. It will write a
PDF titled s_data_preprocess.pdf to your working directory.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"s_data_preprocess.Rmd"</span>, package <span class="op">=</span> <span class="st">"smallsets"</span><span class="op">)</span>,</span>
<span>                  output_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="python-example">Python example<a class="anchor" aria-label="anchor" href="#python-example"></a>
</h3>
<p>Python scripts can be passed to the R command
<code>Smallset_Timeline</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Smallset_Timeline.html">Smallset_Timeline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">s_data</span>, </span>
<span>                  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"s_data_preprocess.py"</span>, package <span class="op">=</span> <span class="st">"smallsets"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Below is the script s_data_preprocess.py, which does the same thing
as s_data_preprocess.R. The smallsets commenting system is the same in
Python.</p>
<p><br><strong>s_data_preprocess.py</strong> (Don’t run this code
block. It’s an example preprocessing script.)</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># smallsets start s_data caption[Remove rows where C2</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># is FALSE.]caption</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>s_data <span class="op">=</span> s_data[s_data[<span class="st">"C2"</span>] <span class="op">==</span> <span class="va">True</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>s_data[<span class="st">"C6"</span>].fillna(value <span class="op">=</span> s_data[<span class="st">"C6"</span>].mean(), inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># smallsets snap s_data caption[Replace missing values in C6 and</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># C8 with column means. Drop C7 because there are too many</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># missing values.]caption</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>s_data[<span class="st">"C8"</span>].fillna(value <span class="op">=</span> s_data[<span class="st">"C8"</span>].mean(), inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>s_data <span class="op">=</span> s_data.drop(columns <span class="op">=</span> [<span class="st">"C7"</span>])</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>s_data[<span class="st">"C9"</span>] <span class="op">=</span> s_data[<span class="st">"C3"</span>] <span class="op">+</span> s_data[<span class="st">"C4"</span>]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># smallsets end s_data caption[Create a new column,</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># C9, by summing C3 and C4.]caption</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="isolate-a-data-deletion">Isolate a data deletion<a class="anchor" aria-label="anchor" href="#isolate-a-data-deletion"></a>
</h3>
<p>If you’d like to isolate a data deletion in an intermediate snapshot,
leave a blank line between the structured comment and the data deletion
code. For example, if we want to split the middle Timeline snapshot into
two snapshots, we can add another structured comment, and blank line,
before the data deletion code.</p>
<p><br><strong>s_data_preprocess_4.R</strong> (Don’t run this code
block. It’s an example preprocessing script.)</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># smallsets start s_data caption[Remove rows where C2</span></span>
<span><span class="co"># is FALSE.]caption</span></span>
<span><span class="va">s_data</span> <span class="op">&lt;-</span> <span class="va">s_data</span><span class="op">[</span><span class="va">s_data</span><span class="op">$</span><span class="va">C2</span> <span class="op">==</span> <span class="cn">TRUE</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C6</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C6</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C6</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># smallsets snap s_data caption[Replace missing values in C6 and</span></span>
<span><span class="co"># C8 with column means.]caption</span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C8</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C8</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># smallsets snap s_data caption[Drop C7 because there are too many</span></span>
<span><span class="co"># missing values.]caption</span></span>
<span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C7</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C9</span> <span class="op">&lt;-</span> <span class="va">s_data</span><span class="op">$</span><span class="va">C3</span> <span class="op">+</span> <span class="va">s_data</span><span class="op">$</span><span class="va">C4</span></span>
<span><span class="co"># smallsets end s_data caption[Create a new column,</span></span>
<span><span class="co"># C9, by summing C3 and C4.]caption</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">145</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Smallset_Timeline.html">Smallset_Timeline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">s_data</span>, </span>
<span>                  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"s_data_preprocess_4.R"</span>, package <span class="op">=</span> <span class="st">"smallsets"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="smallsets_files/figure-html/timeline2-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="selection">Smallset selection<a class="anchor" aria-label="anchor" href="#selection"></a>
</h2>
<p>There are two Smallset decisions to make: how many rows
(<code>rowCount</code>) and how to select them
(<code>rowSelect</code>).</p>
<p>If <code>rowSelect = NULL</code> (the default setting), rows are
selected through a simple random sample. The following code would
randomly sample seven rows for the Smallset.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Smallset_Timeline.html">Smallset_Timeline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">s_data</span>, </span>
<span>                  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"s_data_preprocess.R"</span>, package <span class="op">=</span> <span class="st">"smallsets"</span><span class="op">)</span>, </span>
<span>                  rowCount <span class="op">=</span> <span class="fl">7</span>, rowSelect <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p>To use the other two selection methods, which are optimisation
problems proposed <a href="https://dl.acm.org/doi/epdf/10.1145/3531146.3533175#section.5" class="external-link">here</a>,
you will need a <a href="https://www.gurobi.com/solutions/licensing/" class="external-link">Gurobi license</a> as
they rely on the <a href="https://www.gurobi.com/solutions/gurobi-optimizer/" class="external-link">Gurobi
solver</a> v9.1.2 (free academic licenses are available). Richard
Schuster’s <a href="https://prioritizr.net/articles/gurobi_installation_guide.html" class="external-link">“Gurobi
installation guide”</a> in the <code>prioritizr</code> package provides
step-by-step instructions on installing Gurobi in R.</p>
<p>If <code>rowSelect = 1</code>, the <em>coverage</em> problem is used
to select rows. For each snapshot, it finds at least one example of a
data change, if there is one. You can return the solution to the console
with <code>rowReturn = TRUE</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Smallset_Timeline.html">Smallset_Timeline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">s_data</span>, </span>
<span>                  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"s_data_preprocess.R"</span>, package <span class="op">=</span> <span class="st">"smallsets"</span><span class="op">)</span>, </span>
<span>                  rowCount <span class="op">=</span> <span class="fl">5</span>, rowSelect <span class="op">=</span> <span class="fl">1</span>, rowReturn <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Smallset rows: 27, 42, 95, 96, 99</span></span></code></pre>
<p>After the optimisation problem is solved once, the solution can be
passed to <code>rowNums</code> to avoid having to re-solve it with each
run of <code>Smallset_Timeline</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Smallset_Timeline.html">Smallset_Timeline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">s_data</span>, </span>
<span>                  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"s_data_preprocess.R"</span>, package <span class="op">=</span> <span class="st">"smallsets"</span><span class="op">)</span>, </span>
<span>                  rowCount <span class="op">=</span> <span class="fl">5</span>, rowNums <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">27</span>, <span class="fl">42</span>, <span class="fl">95</span>, <span class="fl">96</span>, <span class="fl">99</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="smallsets_files/figure-html/timeline3-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Here, the <em>coverage</em> solution misses a data edit example in
the second snapshot, motivating use of the other selection method
(<code>rowSelect = 2</code>): the <em>coverage + variety</em>
optimisation problem, which looks for rows affected by the preprocessing
steps differently. <strong>The drawback of <code>rowSelect = 2</code> is
runtime for large datasets.</strong> One potential workaround to a long
runtime is building a Timeline from a sample of the dataset. However,
this should be done with caution.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/Smallset_Timeline.html">Smallset_Timeline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">s_data</span>, </span>
<span>                  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"s_data_preprocess.R"</span>, package <span class="op">=</span> <span class="st">"smallsets"</span><span class="op">)</span>, </span>
<span>                  rowSelect <span class="op">=</span> <span class="fl">2</span>, rowReturn <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Smallset rows: 3, 32, 80, 97, 99</span></span></code></pre>
<p><img src="smallsets_files/figure-html/timeline4-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="customisation">Timeline customisation<a class="anchor" aria-label="anchor" href="#customisation"></a>
</h2>
<p>There are built-in options to customise a Timeline. The examples in
this section highlight some of them. See <code><a href="../reference/Smallset_Timeline.html">?Smallset_Timeline</a></code>
for a full list of options.</p>
<p><br><strong>Example 1</strong></p>
<p>Some differences: custom colour palette, data in the snapshots,
highlighting missing data, a different font, and no ghost data.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">145</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Smallset_Timeline.html">Smallset_Timeline</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">s_data</span>,</span>
<span>  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"s_data_preprocess.R"</span>, package <span class="op">=</span> <span class="st">"smallsets"</span><span class="op">)</span>,</span>
<span>  colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    same <span class="op">=</span> <span class="st">"#E6E3DF"</span>,</span>
<span>    edit <span class="op">=</span> <span class="st">"#FFC500"</span>,</span>
<span>    add <span class="op">=</span> <span class="st">"#5BA2A6"</span>,</span>
<span>    delete <span class="op">=</span> <span class="st">"#DDC492"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  printedData <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  truncateData <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  missingDataTints <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ghostData <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  font <span class="op">=</span> <span class="st">"Palatino"</span>,</span>
<span>  sizing <span class="op">=</span> <span class="fu"><a href="../reference/sets_sizing.html">sets_sizing</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>  labelling <span class="op">=</span> <span class="fu"><a href="../reference/sets_labelling.html">sets_labelling</a></span><span class="op">(</span>labelCol <span class="op">=</span> <span class="st">"darker"</span>, labelColDif <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="smallsets_files/figure-html/timeline5-1.png" width="672" style="display: block; margin: auto;"></p>
<p><br><strong>Example 2</strong></p>
<p>Some differences: use of a built-in colour palette, split into two
rows, and rotated column names.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">145</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Smallset_Timeline.html">Smallset_Timeline</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">s_data</span>,</span>
<span>  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"s_data_preprocess.R"</span>, package <span class="op">=</span> <span class="st">"smallsets"</span><span class="op">)</span>,</span>
<span>  colours <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  ghostData <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  missingDataTints <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  font <span class="op">=</span> <span class="st">"Arial Rounded MT Bold"</span>,</span>
<span>  spacing <span class="op">=</span> <span class="fu"><a href="../reference/sets_spacing.html">sets_spacing</a></span><span class="op">(</span></span>
<span>    captions <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    rows <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    degree <span class="op">=</span> <span class="fl">45</span>,</span>
<span>    header <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span>,</span>
<span>  sizing <span class="op">=</span> <span class="fu"><a href="../reference/sets_sizing.html">sets_sizing</a></span><span class="op">(</span></span>
<span>    legend <span class="op">=</span> <span class="fl">7</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="smallsets_files/figure-html/timeline6-1.png" width="480" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="alttext">Alt text<a class="anchor" aria-label="anchor" href="#alttext"></a>
</h2>
<p>You can retrieve alternative text (alt text) for your Smallset
Timeline. When <code>altText = TRUE</code>, a draft of alt text is
printed to the console. It can be copied from the console, revised for
readability, and included with the figure.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">145</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Smallset_Timeline.html">Smallset_Timeline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">s_data</span>, </span>
<span>                  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"s_data_preprocess.R"</span>, package <span class="op">=</span> <span class="st">"smallsets"</span><span class="op">)</span>, </span>
<span>                  altText <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code>The Smallset Timeline contains 3 Smallset snapshots. Data edits are represented with the colour slategray2. Data additions are represented with the colour plum. Data deletions are represented with the colour navajowhite. Snapshot 1 is 5 rows by 8 columns. The columns, in order from left to right, are: C1, C2, C3, C4, C5, C6, C7, and C8. 1 row is navajowhite. The caption is quote Remove rows where C2 is FALSE. unquote. Snapshot 2 is 4 rows by 8 columns. Column C7 is navajowhite. 3 cells are slategray2. The caption is quote Replace missing values in C6 and C8 with column means. Drop C7 because there are too many missing values. unquote. Snapshot 3 is 4 rows by 8 columns. Column C9 is plum. The caption is quote Create a new column, C9, by summing C3 and C4. unquote.</code></pre>
</div>
<div class="section level2">
<h2 id="resume">Resume markers<a class="anchor" aria-label="anchor" href="#resume"></a>
</h2>
<p>A resume marker is a vertical line between snapshots signalling that
preprocessing stopped to run an analysis and then resumed to facilitate
a new/revised analysis. It is added to a Timeline with a <em>resume</em>
instruction in a structured comment.</p>
<p>In this example, we resume data preprocessing to transform C9 into a
categorical variable.</p>
<p><br><strong>s_data_preprocess_resume.R</strong> (Don’t run this
code block. It’s an example preprocessing script.)</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># smallsets start s_data caption[Remove rows where C2</span></span>
<span><span class="co"># is FALSE.]caption</span></span>
<span><span class="va">s_data</span> <span class="op">&lt;-</span> <span class="va">s_data</span><span class="op">[</span><span class="va">s_data</span><span class="op">$</span><span class="va">C2</span> <span class="op">==</span> <span class="cn">TRUE</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C6</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C6</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C6</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># smallsets snap s_data caption[Replace missing values in C6 and</span></span>
<span><span class="co"># C8 with column means. Drop C7 because there are too many</span></span>
<span><span class="co"># missing values.]caption</span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C8</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C8</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C7</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co"># smallsets snap s_data caption[Create a new column,</span></span>
<span><span class="co"># C9, by summing C3 and C4.]caption</span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C9</span> <span class="op">&lt;-</span> <span class="va">s_data</span><span class="op">$</span><span class="va">C3</span> <span class="op">+</span> <span class="va">s_data</span><span class="op">$</span><span class="va">C4</span></span>
<span></span>
<span><span class="co"># smallsets resume s_data caption[Ran the analysis </span></span>
<span><span class="co"># and decided to make a change.]caption</span></span>
<span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">s_data</span><span class="op">$</span><span class="va">C9</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">3</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">s_data</span><span class="op">$</span><span class="va">C10</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">s_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span></span>
<span>  <span class="va">C9</span>,</span>
<span>  <span class="va">t</span>,</span>
<span>  include.lowest <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Low"</span>, <span class="st">"Med"</span>, <span class="st">"High"</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># smallsets end s_data caption[Create a new categorical </span></span>
<span><span class="co"># column, C10, based on C9 terciles.]caption</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">145</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/Smallset_Timeline.html">Smallset_Timeline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">s_data</span>, </span>
<span>                  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"s_data_preprocess_resume.R"</span>, package <span class="op">=</span> <span class="st">"smallsets"</span><span class="op">)</span>, </span>
<span>                  sizing <span class="op">=</span> <span class="fu"><a href="../reference/sets_sizing.html">sets_sizing</a></span><span class="op">(</span></span>
<span>                    columns <span class="op">=</span> <span class="fl">1.8</span>,</span>
<span>                    captions <span class="op">=</span> <span class="fl">1.8</span>,</span>
<span>                    legend <span class="op">=</span> <span class="fl">7</span>,</span>
<span>                    icons <span class="op">=</span> <span class="fl">.8</span></span>
<span>                    <span class="op">)</span>,</span>
<span>                  spacing <span class="op">=</span> <span class="fu"><a href="../reference/sets_spacing.html">sets_spacing</a></span><span class="op">(</span></span>
<span>                    captions <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                    degree <span class="op">=</span> <span class="fl">60</span>,</span>
<span>                    header <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>                    right <span class="op">=</span> <span class="fl">2</span></span>
<span>                    <span class="op">)</span></span>
<span>                  <span class="op">)</span></span></code></pre></div>
<p><img src="smallsets_files/figure-html/timeline7-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lydia R. Lucchesi.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
